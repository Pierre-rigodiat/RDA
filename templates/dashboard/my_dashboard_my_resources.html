{% extends "nmrr/extra/small_intro.html" %}
{% load staticfiles %}
{% load auth_extras %}
{% load dict_key_extras %}
{% comment %}
<!--
################################################################################
#
# File Name: my_dashboard_my_resources.html
# Application: profile/dashboard
# Description:
#
# Author: Sharief Youssef
#         sharief.youssef@nist.gov
#
#		  Xavier SCHMITT
#		  xavier.schmitt@nist.gov
#
# Sponsor: National Institute of Standards and Technology
#
################################################################################
-->
{% endcomment %}
{% block menu %}{% include 'nmrr/menus/main.html' with active_tab='profile' %}{% endblock %}

{% block content %}
  <div id="body">

	<div class="width">

    {% if not template %}
            <div class="btn-group pull-right">
                <button class="btn clear-fields" onclick="location.href='/dashboard'"><i class="icon-file"></i> My Dashboard</button>
	            <button class="btn clear-fields" onclick="location.href='/curate'"><i class="icon-file"></i> Add New Resource</button>
            </div>
            <h3>My Resources</h3>
    {% endif%}
    {% if template == "organization" %}
            <div class="btn-group pull-right">
                <button class="btn clear-fields" onclick="location.href='/dashboard'"><i class="icon-file"></i> My Dashboard</button>
                <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=organization'"><i class="icon-file"></i> Add New Organization</button>
            </div>
            <h3>My Organizations</h3>
    {% endif%}
    {% if template == "datacollection" %}
      <div class="btn-group pull-right">
          <button class="btn clear-fields" onclick="location.href='/dashboard'"><i class="icon-file"></i> My Dashboard</button>
          <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=datacollection'"><i class="icon-file"></i> Add New Data Collection</button>
          <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=repository'"><i class="icon-file"></i> New Repository</button>
          <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=projectarchive'"><i class="icon-file"></i> New Project Archive</button>
          <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=database'"><i class="icon-file"></i> New Database</button>
      </div>
      <h3>My Data Collections</h3>
    {% endif%}
    {% if template == "dataset" %}
        <div class="btn-group pull-right">
            <button class="btn clear-fields" onclick="location.href='/dashboard'"><i class="icon-file"></i> My Dashboard</button>
            <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=dataset'"><i class="icon-file"></i> Add New Dataset</button>
        </div>
        <h3>My Datasets</h3>
    {% endif%}
    {% if template == "service" %}
        <div class="btn-group pull-right">
            <button class="btn clear-fields" onclick="location.href='/dashboard'"><i class="icon-file"></i> My Dashboard</button>
            <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=service'"><i class="icon-file"></i> Add New Service</button>
        </div>
        <h3>My Services</h3>
    {% endif%}
    {% if template == "informational" %}
        <div class="btn-group pull-right">
            <button class="btn clear-fields" onclick="location.href='/dashboard'"><i class="icon-file"></i> My Dashboard</button>
            <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=informational'"><i class="icon-file"></i> Add New Informational Site</button>
        </div>
            <h3>My Informational Sites</h3>
    {% endif%}
    {% if template == "software" %}
        <div class="btn-group pull-right">
            <button class="btn clear-fields" onclick="location.href='/dashboard'"><i class="icon-file"></i> My Dashboard</button>
            <button class="btn clear-fields" onclick="location.href='/curate/start_curate?template=software'"><i class="icon-file"></i> Add New Software</button>
        </div>
        <h3>My Software</h3>
    {% endif%}

<br>
<br>

        <ul class="nav nav-tabs">
                {% if not ispublished %} <li class="active"> {%else%} <li> {% endif%} <a href="/dashboard/resources{% if template  %}?template={{template}}{% endif%}">All</a></li>
                {% if ispublished == "true" %} <li class="active"> {%else%} <li> {% endif%}<a href="/dashboard/resources?{% if template  %}template={{template}}{% endif%}&ispublished=true">Published</a></li>
                {% if ispublished == "false" %} <li class="active"> {%else%} <li> {% endif%}<a href="/dashboard/resources?{% if template  %}template={{template}}{% endif%}&ispublished=false">Not Published</a></li>
        </ul>

<table>
<tr>

<td align="center" style={% if not template %}" border-color:#000000;border-size:15px"{% endif%}>
    <a href="/dashboard/resources{% if ispublished == "true" %}?ispublished=true{% elif ispublished == "false" %}?ispublished=false{% endif%}">
    <div align="center"><img width="100" src="/static/img/allresources.png"><br>
    All Resources</div>
    </a>
</td>
<td align="center" style={% if template == "organization" %}"border-color:#000000;border-size:15px"{% endif%}>
    <a href="/dashboard/resources?template=organization{% if ispublished == "true" %}&ispublished=true{% elif ispublished == "false" %}&ispublished=false{% endif%}">
    <div align="center"><img width="100" src="/static/img/organization.png"><br>
    Organizations</div>
    </a>
</td>
<td align="center" style={% if template == "datacollection" %}"border-color:#000000;border-size:15px"{% endif%}>
    <a href="/dashboard/resources?template=datacollection{% if ispublished == "true" %}&ispublished=true{% elif ispublished == "false" %}&ispublished=false{% endif%}">
    <div align="center"><img width="100" src="/static/img/datacollection.png"><br>
    Data Collections</div>
    </a>
</td>
<td align="center" style={% if template == "dataset" %}"border-color:#000000;border-size:15px"{% endif%}>
    <a href="/dashboard/resources?template=dataset{% if ispublished == "true" %}&ispublished=true{% elif ispublished == "false" %}&ispublished=false{% endif%}">
    <div align="center"><img width="100" src="/static/img/dataset.png"><br>
    Datasets</div>
    </a>
</td>
<td align="center" style={% if template == "service" %}"border-color:#000000;border-size:15px"{% endif%}>
    <a href="/dashboard/resources?template=service{% if ispublished == "true" %}&ispublished=true{% elif ispublished == "false" %}&ispublished=false{% endif%}">
    <div align="center"><img width="100" src="/static/img/service.png"><br>
    Services</div>
    </a>
</td>
<td align="center" style={% if template == "informational" %}"border-color:#000000;border-size:15px"{% endif%}>
    <a href="/dashboard/resources?template=informational{% if ispublished == "true" %}&ispublished=true{% elif ispublished == "false" %}&ispublished=false{% endif%}">
    <div align="center"><img width="100" src="/static/img/informational.png"><br>
    Informational</div>
    </a>
</td>
<td align="center" style={% if template == "software" %}"border-color:#000000;border-size:15px"{% endif%}>
    <a href="/dashboard/resources?template=software{% if ispublished == "true" %}&ispublished=true{% elif ispublished == "false" %}&ispublished=false{% endif%}">
    <div align="center"><img width="100" src="/static/img/software.jpg"><br>
    Software</div>
    </a>
</td>
</tr>
</table>

{% if XMLdatas%}
{% with canEdit=request.user|has_perm:'curate.curate_edit_document' canDelete=request.user|has_perm:'curate.curate_delete_document' %}

{% for XMLdata in XMLdatas %}
    {% with XMLdata|get:"_id" as XMLdata_id %}
<br>
<br>
            <div style="background-color:#eeeeee" id="{{XMLdata_id}}">
                <table class="data-table">
                <tr>
                <td style="width:250px">
                <div style="margin-top:10px;">Resource Name</div></td>
                <td>
                    {% if XMLdata.content.Resource.identity.title %}
                        {{ XMLdata.content.Resource.identity.title }}
                    {%else%}
                        <script>
                            document.write('{{ XMLdata.title }}'.replace(/\.[^/.]+$/, ""));
                        </script>
                    {% endif %}
                <div style="float:right">
                    {% autoescape on %}
                            <a href="/dashboard/detail?type=record&id={{XMLdata_id}}"><span class="icon legend result">
                                View
                            </span></a>
                    {% endautoescape %}
                </div>
                </td>
                </tr>
                <tr>
                <td>
                    {% if canEdit %}
                    <a href="/curate/enter-data?id={{XMLdata_id}}" class="btn clear-fields">Edit</a>
                    {% endif %}
                    {% if canDelete and not XMLdata.publicationdate %}
                    <a onclick="deleteResult('{{XMLdata_id}}')" class="btn clear-fields">Delete</a>
                    {% endif %}

                </td>
                <td align="right">
                    <div style="float:right">
                    {% if XMLdata.publicationdate %}
                        <font size="2">Published on: {{ XMLdata.publicationdate }} &nbsp;&nbsp;&nbsp;</font>
                    {% endif %}
                    {% if not XMLdata.publicationdate %}
                        <font size="2">Published on: Never &nbsp;&nbsp;&nbsp;</font>
                    {% endif %}
                    {% if not XMLdata.ispublished %}
                        <a onclick="updatePublish('{{XMLdata_id}}')" class="btn clear-fields">Publish</a>
                    {% endif %}
                        </div>
                </td></tr></table>
                </div>

    {% endwith%}
{% endfor %}
{% endwith%}
{%else%}
        <br>
        <br>
No Resources found
{%endif%}

    </div>
	</div>

            <div class="clear"></div>
    {% endblock %}

{% block popups %}
<div id="dialog-delete-result" title="Delete Document" style="display:none;">
Are you sure you want to delete this document?
</div>
<div id="dialog-publish" title="Publish Document" style="display:none;">
Are you sure you want to publish this document?
</div>
<div id="dialog-unpublish" title="Unpublish Document" style="display:none;">
Are you sure you want to unpublish this document?
</div>
<div id="dialog-detail-result" title="Resource Details" style="display:none;">
<div id="result_detail">
</div>
</div>
{% endblock %}

{% block extrajs %}
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <script src="{% static 'inc/controllers/js/dashboard.js' %}"></script>
{% endblock %}